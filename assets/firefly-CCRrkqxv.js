import{k as C,$ as D,l as M,m as b,p as i}from"./index-BEhghbfi.js";const F=function(e){const s=e?"#fff62b":"#8cd629",t=10;let h=t,n=t;const r=t*2,o=t*2,{canvas:c,context:l}=M({width:r,height:o});let a=l.createRadialGradient(t,t,0,t,t,t);return a.addColorStop(0,"#fff"),a.addColorStop(.2,"#fff"),a.addColorStop(.3,`${s}`),a.addColorStop(.5,`${s}cc`),a.addColorStop(.6,`${s}aa`),a.addColorStop(.7,`${s}88`),a.addColorStop(.8,`${s}66`),a.addColorStop(1,"transparent"),l.arc(h,n,t,0,Math.PI*2),l.fillStyle=a,l.fill(),c},w=(e,s,t)=>{const h=Math.random()*Math.PI*2,n=t*Math.sqrt(Math.random()),r=e+n*Math.cos(h),o=s+n*Math.sin(h);return{x:r,y:o}};class p{constructor(s){this.context=null,this.canvas=null,this.creating=!1,this.fireflies=[],this.fireflyImg=[],this.maxPoi={x:0,y:0},this.startPoi={x:0,y:0},this.count=0,this.pathRandom=!0,this.speed=1,this.createSpeed=5,this.followMouse=!1,this.itemSpeed=1,this.mousedownSpeedRatio=10,this.mouseDownSign=!1,this.mousePoi={x:0,y:0},this.randomPaths=[],this.randomPathItv=0;const{el:t,count:h=50,ex:n=2e3,ey:r=100,sx:o,sy:c,success:l,pathRandom:a=!0,speed:d=1,createSpeed:x=5,followMouse:m=!1,mousedownSpeedRatio:f=10}=s;this.startPoi={x:o,y:c},this.maxPoi={x:n,y:r},this.mousePoi={x:n/2,y:r/2},this.mousedownSpeedRatio=f,this.followMouse=m,this.pathRandom=a,this.speed=d||1,this.createSpeed=x||5,this.count=h,this.mouseDownSign=!1;let P=C(s.el)?t:D(t);const{canvas:y,context:u}=M({width:n,height:r});this.canvas=y,this.context=u,P.appendChild(y),this.init(),typeof l=="function"&&l()}}const V=function(){this.randomPaths=[];const e=i(1,4);for(let s=0;s<e;s++){let t=this.createPathRandom(i(4,6));this.randomPaths.push(t)}},$=function(){const e=F(0),s=F(1);this.fireflyImg.push(e,s),this.setRandomPath(),this.randomPathItv=setInterval(()=>{this.setRandomPath()},1e3*5),this.mouseMove=b(t=>{this.updatePoi(t)},50),this.followMouse&&this.canvas.addEventListener("mousemove",this.mouseMove),this.followMouse&&(this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUp.bind(this))),this.increasedFirefly(this.count)},E=function(e){const s={x:e.clientX,y:e.clientY};this.mousePoi=s},T=function(){this.mouseDownSign=!0,this.setFirefliesVt(this.mousedownSpeedRatio),this.setRandomPath(),clearInterval(this.randomPathItv),this.randomPathItv=null},L=function(){this.mouseDownSign=!1,this.setFirefliesVt(1),this.setRandomPath(),this.randomPathItv=setInterval(()=>{this.setRandomPath()},1e3*10)},U=function(e=1){this.itemSpeed=e},A=function(){const e=this.maxPoi.x,s=this.maxPoi.y;return{x:i(0,e),y:i(0,s)}},k=function(e){const s=this.createRandomPoint();e.paths.push(s)},q=function(e=20){let s=0,t=[],h=[{x:0,y:0},{x:this.maxPoi.x,y:0},{x:this.maxPoi.x,y:this.maxPoi.y},{x:0,y:this.maxPoi.y}];for(t.push(h[i(0,3)]);s<e;){const n=this.createRandomPoint();t.push(n),s++}return t},G=function(){let e=this.startPoi.x,s=[];s.push(this.startPoi);const t=this.maxPoi.x,h=t/20,n=5,r=this.maxPoi.y;for(;e<t;){let o=i(e,e+h),c=i(n,r);if(e=o,s.push({x:o,y:c}),i(0,100)<20){const a=s.lastItem(1),d=a.y>c;let x=i(o-h,o),m=d?i(n,a.y):i(a.y,r),f=i(o-2*h,o),P=c+i(-10,10),y=i(o-h,o),u=d?i(a.y,r):i(n,a.y),I=o+i(-20,20),S=c+i(-20,20);s.push({x,y:m},{x:f,y:P},{x:y,y:u},{x:I,y:S}),e=I}}return s},N=function(e=!1,s){let t=i(0,2);const h=this.fireflies[t],n=i(10,30)/10,r=i(0,1),o=e?h.frame+i(-120,120):i(256,1024)/this.speed,c=1/o,l=e?c*i(5,20)*this.itemSpeed:0,a=l*c,d=0,x=i(2,10)/10,m=i(2,6)/500,f=i(100,400),P=e?h.paths.map(u=>({x:u.x+i(-f,f)/10,y:u.y+i(-f,f)/10})):this.pathRandom?this.createPathRandom(6):this.createPathIncreasing(),y={radius:n,imgType:r,t:a,vt:c,nextFrame:l,frame:o,pathIndex:d,alpha:x,flashV:m,paths:P,onActive:!1,symbol:-1};this.fireflies.push(y)},O=function(e){if(this.creating)return;let s=0;this.creating=!0;const t=setInterval(()=>{const h=i(0,100)>5&&this.fireflies.length>3;s<e?(s++,this.createFirefly(h,s)):(clearInterval(t),this.creating=!1)},1e3/this.createSpeed)};function X(e,s,t,h,n){const r=(t.x-e.x)*.5,o=(h.x-s.x)*.5,c=(t.y-e.y)*.5,l=(h.y-s.y)*.5,a=n*n,d=n*a;return{x:(2*s.x-2*t.x+r+o)*d+(-3*s.x+3*t.x-2*r-o)*a+r*n+s.x,y:(2*s.y-2*t.y+c+l)*d+(-3*s.y+3*t.y-2*c-l)*a+c*n+s.y}}const Y=function(e,s){let{paths:t,frame:h,nextFrame:n,vt:r,pathIndex:o,t:c,radius:l,imgType:a,alpha:d,flashV:x,symbol:m}=e;const f=o===0?t[0]:t[o-1],P=t[o],y=t[o+1],u=o===t.length-2?t[t.length-1]:t[o+2],{x:I,y:S}=X(f,P,y,u,c),g=this.context;if(g.save(),g.beginPath(),g.globalAlpha=d,g.drawImage(this.fireflyImg[a],I-l,S-l,l*2,l*2),g.restore(),c+=r*this.itemSpeed,d+=x*m,n+=1*this.itemSpeed,d>1&&(d=1,m=-1),d<.2&&(d=.2,m=1),n>=h||c>=1){if(o++,c=0,n=0,this.mouseDownSign){t.splice(o+1,t.length-1);const R=this.mousePoi.x,v=this.mousePoi.y;t.push(w(R,v,i(-50,50))),t.push(w(R,v,i(-50,50)))}else if(o>=t.length-4){const R=this.randomPaths[s%this.randomPaths.length].map(v=>w(v.x,v.y,i(-50,50)));t.push(...R)}o>=3&&(e.paths.shift(),o--)}e.t=c,e.alpha=d,e.nextFrame=n,e.pathIndex=o,e.symbol=m,e.alpha=d},j=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.fireflies.forEach((e,s)=>{this.flyPath(e,s)})};p.prototype.init=$;p.prototype.mouseDown=T;p.prototype.mouseUp=L;p.prototype.updatePoi=E;p.prototype.setFirefliesVt=U;p.prototype.addPointToPath=k;p.prototype.createRandomPoint=A;p.prototype.increasedFirefly=O;p.prototype.setRandomPath=V;p.prototype.createPathRandom=q;p.prototype.createPathIncreasing=G;p.prototype.createFirefly=N;p.prototype.flying=j;p.prototype.flyPath=Y;export{p as F};
